{"ast":null,"code":"var _jsxFileName = \"/Users/user/Desktop/sizl/mono_pop/packages/basic/src/container/BasicDefect.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState } from 'react';\nimport { ExcelTable, Header as PageHeader, RequestMethod, columnlist, excelDownload } from 'shared'; // @ts-ignore\n\nimport { SelectColumn } from 'react-data-grid';\nimport Notiflix from \"notiflix\";\nimport { useRouter } from 'next/router';\nimport ButtonGroup from '../../../main/component/ButtonGroup';\nconst title = '권한 관리';\n\nconst BasicDefect = ({\n  page,\n  keyword,\n  option\n}) => {\n  const {\n    0: processBasicRow,\n    1: setProcessBasicRow\n  } = useState([]);\n  const {\n    0: processColumn,\n    1: setProcessColumn\n  } = useState(columnlist[`pause`]);\n  const {\n    0: excelUploadOpen,\n    1: setExcelUploadOpen\n  } = useState(false);\n  const {\n    0: pauseBasicRow,\n    1: setPauseBasicRow\n  } = useState([]);\n  const {\n    0: pauseColumn,\n    1: setPauseColumn\n  } = useState(columnlist[`defectReason`]);\n  const {\n    0: selectRow,\n    1: setSelectRow\n  } = useState(0);\n  const {\n    0: processId,\n    1: setProcessId\n  } = useState(0);\n  const {\n    0: state,\n    1: setState\n  } = useState(false);\n  const {\n    0: selectList,\n    1: setSelectList\n  } = useState(new Set());\n  const router = useRouter();\n  useEffect(() => {\n    if (processBasicRow.length > 0) {\n      LoadPauseList(processBasicRow[selectRow].process_id);\n    }\n  }, [selectRow]);\n\n  const cleanUpBasicData = res => {\n    let tmpRow = [];\n    tmpRow = res.data.results.info_list.map((column, index) => {\n      let menuData = {};\n      menuData = {\n        index: index + 1,\n        width: column.width // id:Math.random()*100\n        // id: info.ppr_id,\n        // name: info.reason,\n\n      };\n      let random_id = Math.random() * 1000;\n      return _objectSpread(_objectSpread({\n        id: random_id\n      }, column), menuData);\n    });\n    setPauseBasicRow([...tmpRow]);\n  };\n\n  const LoadPauseList = async value => {\n    const res = await RequestMethod(\"get\", `defectReasonList`, {\n      path: {\n        page: 1,\n        renderItem: 51,\n        process_id: value\n      }\n    });\n\n    if (res && res.status === 200) {\n      let tmpColumn = columnlist[`defectReason`];\n      tmpColumn = tmpColumn.map((value, index) => {\n        return _objectSpread(_objectSpread({}, value), {}, {\n          key: value.key,\n          name: value.name,\n          width: value.width\n        });\n      });\n      setPauseColumn(tmpColumn); // tmpColumn.push({key:})\n\n      let tmpRow = [];\n      tmpRow = res.results.info_list.map((column, index) => {\n        let menuData = {};\n        menuData = {\n          index: index + 1,\n          width: column.width // id:Math.random()*100\n          // id: info.ppr_id,\n          // name: info.reason,\n\n        };\n        let random_id = Math.random() * 1000;\n        return _objectSpread(_objectSpread({\n          id: random_id\n        }, column), menuData);\n      });\n      setPauseBasicRow([...tmpRow]);\n      Notiflix.Loading.remove(300);\n    } else {\n      Notiflix.Loading.remove(300);\n    }\n  };\n\n  const LoadBasic = async () => {\n    Notiflix.Loading.standard();\n    const res = await RequestMethod('get', `processList`, {\n      path: {\n        page: 1,\n        renderItem: 51\n      }\n    });\n\n    if (res && res.status === 200) {\n      if (res.results.info_list.length > 0) {\n        setProcessId(res.results.info_list[selectRow].process_id);\n      }\n\n      let tmpColumn = columnlist[`pause`];\n      let tmpRow = [];\n      tmpColumn = tmpColumn.map(column => {\n        let menuData = {};\n        res.results.menus.map(menu => {\n          if (menu.colName === column.key) {\n            menuData = {\n              id: menu.id,\n              name: menu.title,\n              width: 1560\n            };\n          }\n        });\n        return _objectSpread(_objectSpread({}, column), menuData);\n      });\n      tmpRow = res.results.info_list;\n\n      if (res.results.info_list.length > 0) {\n        LoadPauseList(res.results.info_list[selectRow].process_id);\n      } else {\n        Notiflix.Loading.remove(300);\n      }\n\n      setProcessColumn(tmpColumn);\n      setProcessBasicRow([...tmpRow.map(row => {\n        return _objectSpread({}, row);\n      })]);\n    } else if (res.state === 401) {\n      Notiflix.Report.failure('불러올 수 없습니다.', '권한이 없습니다.', '확인', () => {\n        router.back();\n      });\n    }\n  };\n\n  const downloadExcel = () => {\n    let tmpSelectList = [];\n    pauseBasicRow.map(row => {\n      tmpSelectList.push(selectList.has(row.id));\n    });\n    excelDownload(pauseColumn, pauseBasicRow, `공정별 불량유형 등록`, '공정별 불량유형 등록', tmpSelectList);\n  };\n\n  const buttonEvents = async index => {\n    switch (index) {\n      case 0:\n        setExcelUploadOpen(true);\n        return;\n\n      case 1:\n        downloadExcel();\n        return;\n\n      case 2:\n        let dataRow = {};\n        columnlist[`defectReason`].map((key, index) => {\n          if (key.key === \"index\") {\n            dataRow[key.key] = pauseBasicRow.length + 1;\n            dataRow.id = Math.random() * 100;\n          } else {\n            dataRow[key.key] = \"\";\n          }\n        });\n\n        if (processId !== 0) {\n          pauseBasicRow.push(_objectSpread({}, dataRow));\n          setPauseBasicRow([...pauseBasicRow]);\n        } else {\n          Notiflix.Report.warning(\"선택된 공정이 없습니다.\", \"\", \"확인\");\n        } // pauseBasicRow.push({...dataRow})\n        // setPauseBasicRow([...pauseBasicRow])\n\n\n        return;\n\n      case 3:\n        // let validation = true;\n        Notiflix.Loading.standard();\n        let savePauseBasicRow = [];\n        pauseBasicRow.map(value => {\n          if (value.reason === \"\" || value.reason === undefined) {// validation = false;\n          } else {\n            savePauseBasicRow.push(value);\n          }\n        });\n\n        if (pauseBasicRow.length > 0) {\n          RequestMethod(\"post\", `defectSave`, {\n            process_id: processBasicRow[selectRow].process_id,\n            reasons: savePauseBasicRow\n          }).then(() => {\n            Notiflix.Loading.remove(300);\n            Notiflix.Report.success(\"저장되었습니다.\", \"\", \"확인\");\n            LoadBasic();\n          });\n        } else {\n          Notiflix.Loading.remove(300);\n          Notiflix.Report.warning(\"저장할 데이터가 없습니다\", \"\", \"확인\");\n        }\n\n        return;\n\n      case 4:\n        Notiflix.Confirm.show(\"경고\", \"삭제하시겠습니까?\", \"확인\", \"취소\", async () => {\n          const idList = [];\n          const spliceArray = [];\n          pauseBasicRow.map((v, i) => {\n            if (selectList.has(v.id)) {\n              spliceArray.push(i);\n              idList.push(v.pdr_id);\n            }\n          });\n          const tmpPauseBasicRow = [...pauseBasicRow];\n          spliceArray.reverse();\n          spliceArray.map((value, index) => {\n            tmpPauseBasicRow.splice(value, 1);\n          });\n          const res = await RequestMethod(\"delete\", `defectDelete`, {\n            reasons: idList.filter(v => v)\n          });\n\n          if (res && res.status === 200) {\n            Notiflix.Report.success(\"삭제되었습니다.\", \"\", \"확인\");\n            sortObject(tmpPauseBasicRow); // LoadPauseList(processBasicRow[selectRow].process_id);\n          }\n        }, () => {});\n    }\n  };\n\n  const sortObject = object => {\n    const compare_qty = (a, b) => {\n      // a should come before b in the sorted order\n      if (a.lengthIndex < b.lengthIndex) {\n        return -1; // a should come after b in the sorted order\n      } else if (a.lengthIndex > b.lengthIndex) {\n        return 1; // a and b are the same\n      } else {\n        return 0;\n      }\n    };\n\n    object.sort(compare_qty);\n    let sortData = object.map((v, index) => {\n      return _objectSpread(_objectSpread({}, v), {}, {\n        index: index + 1,\n        lengthIndex: index + 1\n      });\n    });\n    setPauseBasicRow([...sortData]);\n  };\n\n  useEffect(() => {\n    LoadBasic();\n  }, []);\n  useEffect(() => {\n    if (state) {\n      sortObject(pauseBasicRow);\n      setState(false);\n    }\n  }, [pauseBasicRow]);\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 5\n    }\n  }, __jsx(PageHeader, {\n    title: \"공정별 불량유형 등록\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 7\n    }\n  }), __jsx(ExcelTable, {\n    editable: true,\n    headerList: [...processColumn],\n    row: processBasicRow,\n    setRow: setProcessBasicRow,\n    setSelectRow: setSelectRow,\n    width: 1576,\n    height: 300,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 7\n    }\n  }), __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      margin: \"15px 0\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 7\n    }\n  }, __jsx(\"span\", {\n    style: {\n      color: \"white\",\n      fontSize: 22,\n      fontWeight: \"bold\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 25\n    }\n  }, processBasicRow[selectRow] && processBasicRow[selectRow].name), __jsx(ButtonGroup, {\n    buttons: [\"엑셀로 업로드\", \"엑셀로 받기\", \"행 추가\", \"저장하기\", \"삭제\"],\n    buttonsOnclick: buttonEvents,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 9\n    }\n  })), __jsx(ExcelTable, {\n    editable: true,\n    headerList: [SelectColumn, ...pauseColumn],\n    row: pauseBasicRow,\n    setRow: e => {\n      let tmp = selectList;\n      e.map(v => {\n        if (v.isChange) tmp.add(v.id);\n      });\n      setSelectList(tmp);\n      setState(true);\n      setPauseBasicRow(e);\n    },\n    width: 1570,\n    height: 440 // setSelectList={changeSetSelectList}\n    //@ts-ignore\n    ,\n    setSelectList: setSelectList,\n    selectList: selectList,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport { BasicDefect };","map":{"version":3,"sources":["/Users/user/Desktop/sizl/mono_pop/packages/basic/src/container/BasicDefect.tsx"],"names":["React","useEffect","useState","ExcelTable","Header","PageHeader","RequestMethod","columnlist","excelDownload","SelectColumn","Notiflix","useRouter","ButtonGroup","title","BasicDefect","page","keyword","option","processBasicRow","setProcessBasicRow","processColumn","setProcessColumn","excelUploadOpen","setExcelUploadOpen","pauseBasicRow","setPauseBasicRow","pauseColumn","setPauseColumn","selectRow","setSelectRow","processId","setProcessId","state","setState","selectList","setSelectList","Set","router","length","LoadPauseList","process_id","cleanUpBasicData","res","tmpRow","data","results","info_list","map","column","index","menuData","width","random_id","Math","random","id","value","path","renderItem","status","tmpColumn","key","name","Loading","remove","LoadBasic","standard","menus","menu","colName","row","Report","failure","back","downloadExcel","tmpSelectList","push","has","buttonEvents","dataRow","warning","savePauseBasicRow","reason","undefined","reasons","then","success","Confirm","show","idList","spliceArray","v","i","pdr_id","tmpPauseBasicRow","reverse","splice","filter","sortObject","object","compare_qty","a","b","lengthIndex","sort","sortData","display","justifyContent","margin","color","fontSize","fontWeight","e","tmp","isChange","add"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\nimport {\n  ExcelTable,\n  Header as PageHeader,\n  RequestMethod,\n  columnlist,\n  MAX_VALUE,\n  DropDownEditor,\n  TextEditor,\n  excelDownload,\n  PaginationComponent,\n  ExcelDownloadModal,\n  IExcelHeaderType, IItemMenuType\n} from 'shared'\n// @ts-ignore\nimport {SelectColumn} from 'react-data-grid'\nimport Notiflix from \"notiflix\";\nimport {useRouter} from 'next/router'\nimport {loadAll} from 'react-cookies'\nimport {NextPageContext} from 'next'\nimport TreeViewTable from '../../../main/component/TreeView/TreeView'\nimport {IMenu} from '../../../main/common/@types/type'\nimport {AUTHORITY_LIST} from '../../../main/common/configset'\nimport {AxiosResponse} from 'axios'\nimport styled from 'styled-components'\nimport ButtonGroup from '../../../main/component/ButtonGroup'\n\nexport interface IProps {\n  children?: any\n  page?: number\n  keyword?: string\n  option?: number\n}\n\nconst title = '권한 관리'\n\nconst BasicDefect = ({page, keyword, option}: IProps) => {\n\n  const [processBasicRow, setProcessBasicRow] = useState<any[]>([]);\n  const [processColumn, setProcessColumn] = useState<Array<IExcelHeaderType>>(columnlist[`pause`] );\n\n  const [excelUploadOpen, setExcelUploadOpen] = useState<boolean>(false);\n\n\n  const [pauseBasicRow, setPauseBasicRow] = useState<any[]>([]);\n  const [pauseColumn, setPauseColumn] = useState<Array<IExcelHeaderType>>(columnlist[`defectReason`]);\n  const [selectRow, setSelectRow] = useState<any>(0);\n\n  const [processId, setProcessId] = useState<number>(0);\n\n  const [state, setState] = useState<boolean>(false);\n\n  const [selectList, setSelectList] = useState<Set<any>>(new Set());\n\n  const router = useRouter()\n\n  useEffect(()=>{\n    if(processBasicRow.length > 0){\n      LoadPauseList(processBasicRow[selectRow].process_id);\n    }\n  },[selectRow])\n\n  const cleanUpBasicData = (res:any) => {\n    let tmpRow = [];\n    tmpRow = res.data.results.info_list.map((column: any,index:number) => {\n      let menuData: object = {};\n\n      menuData = {\n        index:index+1,\n        width: column.width,\n        // id:Math.random()*100\n        // id: info.ppr_id,\n        // name: info.reason,\n      }\n      let random_id = Math.random()*1000;\n      return {\n        id: random_id,\n        ...column,\n        ...menuData\n      }\n    })\n    setPauseBasicRow([...tmpRow]);\n  }\n  const LoadPauseList = async (value:string) => {\n    const res = await RequestMethod(\"get\", `defectReasonList`,{\n      path: {\n        page:1,\n        renderItem:51,\n        process_id:value\n      }\n    })\n\n    if(res && res.status === 200){\n      let tmpColumn = columnlist[`defectReason`];\n      tmpColumn = tmpColumn.map((value:any,index:number) => {\n        return {...value, key:value.key, name:value.name, width:value.width}\n      })\n      setPauseColumn(tmpColumn);\n      // tmpColumn.push({key:})\n      let tmpRow = [];\n      tmpRow = res.results.info_list.map((column: any,index:number) => {\n        let menuData: object = {};\n\n        menuData = {\n          index:index+1,\n          width: column.width,\n          // id:Math.random()*100\n          // id: info.ppr_id,\n          // name: info.reason,\n        }\n        let random_id = Math.random()*1000;\n        return {\n          id: random_id,\n          ...column,\n          ...menuData\n        }\n      })\n      setPauseBasicRow([...tmpRow]);\n      Notiflix.Loading.remove(300);\n    }else{\n      Notiflix.Loading.remove(300);\n    }\n  }\n\n  const LoadBasic = async () => {\n    Notiflix.Loading.standard();\n    const res = await RequestMethod('get', `processList`,{\n      path: {\n        page: 1,\n        renderItem: 51,\n      }\n    })\n    if(res && res.status === 200){\n      if(res.results.info_list.length > 0){\n        setProcessId(res.results.info_list[selectRow].process_id)\n      }\n      let tmpColumn = columnlist[`pause`];\n      let tmpRow = []\n      tmpColumn = tmpColumn.map((column: any) => {\n        let menuData: object = {};\n\n        res.results.menus.map((menu: any) => {\n          if(menu.colName === column.key){\n            menuData = {\n              id: menu.id,\n              name: menu.title,\n              width: 1560\n            }\n          }\n        })\n\n        return {\n          ...column,\n          ...menuData\n        }\n      })\n      tmpRow = res.results.info_list\n      if(res.results.info_list.length > 0){\n        LoadPauseList(res.results.info_list[selectRow].process_id);\n      }else{\n        Notiflix.Loading.remove(300);\n      }\n      setProcessColumn(tmpColumn);\n      setProcessBasicRow([...tmpRow.map((row: any) => {\n        return {\n          ...row,\n        }\n      })])\n    }else if (res.state === 401) {\n      Notiflix.Report.failure('불러올 수 없습니다.', '권한이 없습니다.', '확인', () => {\n        router.back()\n      })\n    }\n  }\n\n  const downloadExcel = () => {\n    let tmpSelectList: boolean[] = []\n    pauseBasicRow.map(row => {\n      tmpSelectList.push(selectList.has(row.id))\n    })\n    excelDownload(pauseColumn, pauseBasicRow, `공정별 불량유형 등록`, '공정별 불량유형 등록', tmpSelectList)\n  }\n\n\n  const buttonEvents = async(index:number) => {\n    switch (index) {\n      case 0 :\n        setExcelUploadOpen(true)\n        return\n      case 1 :\n        downloadExcel();\n        return\n      case 2 :\n        let dataRow:any = {};\n\n        columnlist[`defectReason`].map((key:any,index:number)=>{\n          if(key.key === \"index\"){\n            dataRow[key.key] = pauseBasicRow.length+1;\n            dataRow.id = Math.random()*100;\n          }else{\n            dataRow[key.key] = \"\";\n          }\n        })\n\n        if(processId !== 0){\n          pauseBasicRow.push({...dataRow})\n          setPauseBasicRow([...pauseBasicRow])\n        }else{\n          Notiflix.Report.warning(\"선택된 공정이 없습니다.\",\"\",\"확인\");\n        }\n        // pauseBasicRow.push({...dataRow})\n        // setPauseBasicRow([...pauseBasicRow])\n        return\n      case 3 :\n        // let validation = true;\n        Notiflix.Loading.standard();\n        let savePauseBasicRow:any[] = [];\n        pauseBasicRow.map((value)=>{\n          if(value.reason === \"\" || value.reason === undefined){\n            // validation = false;\n          }else{\n            savePauseBasicRow.push(value);\n          }\n        })\n        if(pauseBasicRow.length > 0 ){\n          RequestMethod(\"post\", `defectSave`, {\n            process_id:processBasicRow[selectRow].process_id,\n            reasons:savePauseBasicRow\n          }).then(()=>{\n            Notiflix.Loading.remove(300);\n            Notiflix.Report.success(\"저장되었습니다.\",\"\",\"확인\");\n            LoadBasic();\n          })\n        }else{\n          Notiflix.Loading.remove(300);\n          Notiflix.Report.warning(\"저장할 데이터가 없습니다\", \"\", \"확인\");\n        }\n        return\n\n      case 4 :\n        Notiflix.Confirm.show(\"경고\",\"삭제하시겠습니까?\",\"확인\",\"취소\",\n          async()=>{\n            const idList:number[] = [];\n            const spliceArray:number[] = [];\n\n            pauseBasicRow.map((v,i)=> {\n              if(selectList.has(v.id)){\n                spliceArray.push(i);\n                idList.push(v.pdr_id)\n              }\n            })\n\n            const tmpPauseBasicRow = [...pauseBasicRow];\n            spliceArray.reverse();\n            spliceArray.map((value, index)=>{\n              tmpPauseBasicRow.splice(value, 1);\n            })\n\n            const res = await RequestMethod(\"delete\", `defectDelete`, {reasons:idList.filter(v => v) } );\n\n            if(res && res.status === 200){\n              Notiflix.Report.success(\"삭제되었습니다.\",\"\",\"확인\");\n              sortObject(tmpPauseBasicRow);\n              // LoadPauseList(processBasicRow[selectRow].process_id);\n            }\n          },\n          ()=>{}\n        );\n\n\n    }\n  }\n\n  const sortObject = (object:any) => {\n    const  compare_qty = (a:any, b:any) => {\n      // a should come before b in the sorted order\n      if(a.lengthIndex < b.lengthIndex){\n        return -1;\n        // a should come after b in the sorted order\n      }else if(a.lengthIndex > b.lengthIndex){\n        return 1;\n        // a and b are the same\n      }else{\n        return 0;\n      }\n    }\n\n    object.sort(compare_qty)\n    let sortData = object.map((v:object, index:number)=>{\n      return {...v, index:index+1, lengthIndex:index+1}\n    });\n    setPauseBasicRow([...sortData]);\n\n  }\n\n  useEffect(()=>{\n\n    LoadBasic();\n  },[])\n\n  useEffect(()=>{\n    if(state){\n      sortObject(pauseBasicRow);\n      setState(false);\n    }\n  },[pauseBasicRow])\n  return (\n    <div>\n      <PageHeader title={\"공정별 불량유형 등록\"} />\n      <ExcelTable\n        editable\n        headerList={[\n          ...processColumn\n        ]}\n        row={processBasicRow}\n        setRow={setProcessBasicRow}\n        setSelectRow={setSelectRow}\n        width={1576}\n        height={300}\n      />\n      <div style={{display:\"flex\", justifyContent:\"space-between\", margin:\"15px 0\"}}>\n                        <span style={{color:\"white\", fontSize:22, fontWeight:\"bold\"}}>\n                            {processBasicRow[selectRow] && processBasicRow[selectRow].name}\n                        </span>\n        <ButtonGroup buttons={[ \"엑셀로 업로드\", \"엑셀로 받기\", \"행 추가\", \"저장하기\", \"삭제\"]} buttonsOnclick={buttonEvents}/>\n      </div>\n      <ExcelTable\n        editable\n        headerList={[\n          SelectColumn,\n          ...pauseColumn\n        ]}\n        row={pauseBasicRow}\n        setRow={(e) => {\n          let tmp: Set<any> = selectList\n          e.map(v => {\n            if(v.isChange) tmp.add(v.id)\n          })\n          setSelectList(tmp)\n          setState(true)\n          setPauseBasicRow(e)\n        }}\n        width={1570}\n        height={440}\n        // setSelectList={changeSetSelectList}\n        //@ts-ignore\n        setSelectList={setSelectList}\n        selectList={selectList}\n      />\n    </div>\n  );\n}\n\n\nexport {BasicDefect};\n"]},"metadata":{},"sourceType":"module"}