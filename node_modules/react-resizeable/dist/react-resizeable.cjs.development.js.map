{"version":3,"file":"react-resizeable.cjs.development.js","sources":["../src/styles.ts","../src/debounce.ts","../src/median.ts","../src/random-string.ts","../src/resizeable.tsx","../src/child.tsx"],"sourcesContent":["import styled, { css } from 'styled-components';\n\nexport const Parent = styled.div<ReactResizeable.ResizeableProps>`\n  position: relative;\n  display: flex;\n  flex-direction: ${({ flexDirection }) => flexDirection};\n  height: ${({ height }) => height ?? 'auto'};\n  flex-wrap: initial;\n`;\n\nconst baseResizeStyle = (resizeDir: ReactResizeable.ResizeDirection) => css`\n  resize: ${resizeDir};\n  overflow: 'auto';\n`;\n\nconst resizeStyles = ({\n  resizeable,\n  resizeDir,\n}: ReactResizeable.ChildProps['resize']) => {\n  if (!resizeable && !resizeDir) return;\n\n  return resizeDir === 'both' || resizeDir === 'vertical'\n    ? css`\n        ${baseResizeStyle(resizeDir)};\n        height: auto;\n      `\n    : baseResizeStyle(resizeDir!);\n};\n\nexport const StyledChild = styled.div<ReactResizeable.ChildProps['resize']>`\n  min-height: ${({ minHeight }) => minHeight ?? 'auto'};\n  height: ${({ height }) => height ?? '100%'};\n  overflow: scroll;\n  width: ${({ width }) => width};\n  min-width: ${({ minWidth }) => minWidth ?? 'min-content'};\n  flex-grow: 1;\n\n  ${resizeStyles}\n`;\n","type Procedure = (...args: any[]) => void;\n\nexport const debounce = <F extends Procedure>(func: F, waitFor: number) => {\n  let timeout: ReturnType<typeof setTimeout> | null = null;\n\n  const debounced = (...args: Parameters<F>) => {\n    if (timeout !== null) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n    timeout = setTimeout(() => func(...args), waitFor);\n  };\n\n  return debounced as (...args: Parameters<F>) => ReturnType<F>;\n};\n","export const median = (arr: number[]) => {\n  const mid = Math.floor(arr.length / 2);\n  const sorted = [...arr].sort((a, b) => a - b);\n\n  return arr.length % 2 !== 0\n    ? sorted[mid]\n    : (sorted[mid - 1] + sorted[mid]) / 2;\n};\n","export const generateRandomString = () =>\n  Math.random()\n    .toString(20)\n    .substr(2, 20);\n","import * as React from 'react';\n\nimport { Parent } from './styles';\nimport { debounce } from './debounce';\nimport { median } from './median';\nimport { generateRandomString } from './random-string';\n\nconst Resizeable: React.FC<ReactResizeable.ResizeableProps> = ({\n  children,\n  as = 'div',\n  flexDirection = 'row',\n  height = '100%',\n}) => {\n  const [resizeId] = React.useState(generateRandomString());\n  const parent = React.useRef<HTMLElement>(null);\n  const minWidth = React.useRef(0);\n  const medianRootWidth = React.useRef(0);\n  const totalMinWidths = React.useRef(0);\n  const resizeWidthDiff = React.useRef(0);\n\n  React.useEffect(() => {\n    if (!parent.current) return;\n\n    let widths: number[] = [];\n    let totalByResize = { resizeTotalWidths: 0, nonResizeTotalWidths: 0 };\n\n    Array.from(parent.current.children).map(c => {\n      const width = Number(\n        getComputedStyle(c)\n          .getPropertyValue('min-width')\n          .replace('px', '')\n      );\n      widths = [...widths, width];\n\n      if (getComputedStyle(c).getPropertyValue('resize') === 'none') {\n        totalByResize = {\n          ...totalByResize,\n          nonResizeTotalWidths: totalByResize.nonResizeTotalWidths + width,\n        };\n      } else {\n        totalByResize = {\n          ...totalByResize,\n          resizeTotalWidths: totalByResize.resizeTotalWidths + width,\n        };\n      }\n    });\n\n    minWidth.current = Math.min(...widths);\n\n    totalMinWidths.current = widths.reduce((acc, val) => val + acc, 0);\n\n    medianRootWidth.current = Math.ceil(Math.sqrt(median(widths)));\n\n    resizeWidthDiff.current = Math.abs(\n      totalByResize.resizeTotalWidths - totalByResize.nonResizeTotalWidths\n    );\n  }, [parent]);\n\n  const onResize = React.useCallback(\n    ({ totalMin }: { totalMin?: number } = {}) => {\n      if (!parent.current) return;\n\n      const minToMeasure = totalMin ?? totalMinWidths.current;\n\n      if (minToMeasure >= window.innerWidth) {\n        parent.current.style.flexWrap = 'wrap';\n        parent.current.style.height = 'auto';\n      } else {\n        parent.current.style.flexWrap = '';\n        parent.current.style.height = height;\n      }\n    },\n    [parent, totalMinWidths.current]\n  );\n\n  React.useEffect(() => {\n    // setup MutationObserver\n    const resizeableChildren:\n      | HTMLElement[]\n      | undefined\n      | {}[] = React.Children.map(children, (child, idx) => {\n      if (!React.isValidElement(child)) return child;\n\n      return child.props?.resize?.resizeable\n        ? document.getElementById(`resizeable-${resizeId}-${idx}`)\n        : null;\n    })?.filter(child => Boolean(child));\n\n    const config = {\n      attributes: true,\n      attributeFilter: ['style'],\n      attributeOldValue: true,\n    };\n\n    const callback: MutationCallback = mutationsList => {\n      window.requestAnimationFrame(() => {\n        if (!Array.isArray(mutationsList) || !mutationsList.length) {\n          return;\n        }\n        // Use traditional 'for loops' for IE 11\n        for (let mutation of mutationsList) {\n          if (mutation.type !== 'attributes') return;\n\n          if (mutation.target instanceof HTMLElement) {\n            const newTotalMin =\n              totalMinWidths.current -\n              minWidth.current +\n              mutation.target.offsetWidth +\n              medianRootWidth.current +\n              resizeWidthDiff.current;\n\n            if (newTotalMin >= window.innerWidth) {\n              onResize({\n                totalMin: newTotalMin,\n              });\n            }\n          }\n        }\n      });\n    };\n\n    const observer = new MutationObserver(callback);\n\n    resizeableChildren?.forEach(el => {\n      if (el instanceof HTMLElement) {\n        observer.observe(el, config);\n      }\n    });\n    return () => {\n      observer.disconnect();\n    };\n  }, []);\n\n  React.useEffect(() => {\n    // on initial mount ensure proper flex layout\n    onResize();\n  }, [onResize]);\n\n  React.useEffect(() => {\n    // @ts-ignore it complains we're not typing the event but we don't care about it\n    window.addEventListener('resize', debounce(onResize, 200));\n\n    return () => {\n      // @ts-ignore it complains we're not typing the event but we don't care about it\n      window.removeEventListener('resize', onResize);\n    };\n  }, [onResize]);\n\n  return (\n    <Parent as={as} ref={parent} flexDirection={flexDirection} height={height}>\n      {React.Children.map(children, (child, idx) => {\n        if (!React.isValidElement(child)) return child;\n\n        return React.cloneElement(child, {\n          ...child.props,\n          id: `resizeable-${resizeId}-${idx}`,\n        });\n      })}\n    </Parent>\n  );\n};\n\nexport default Resizeable;\n","import * as React from 'react';\n\nimport { StyledChild } from './styles';\n\nconst Child: React.FC<ReactResizeable.ChildProps> = React.forwardRef(\n  ({ children, resize, ...props }, ref) => (\n    <StyledChild ref={ref} {...resize} {...props}>\n      {children}\n    </StyledChild>\n  )\n);\n\nexport default Child;\n"],"names":["Parent","styled","div","flexDirection","height","baseResizeStyle","resizeDir","css","resizeStyles","resizeable","StyledChild","minHeight","width","minWidth","debounce","func","waitFor","timeout","debounced","args","clearTimeout","setTimeout","median","arr","mid","Math","floor","length","sorted","sort","a","b","generateRandomString","random","toString","substr","Resizeable","children","as","React","resizeId","parent","medianRootWidth","totalMinWidths","resizeWidthDiff","current","widths","totalByResize","resizeTotalWidths","nonResizeTotalWidths","Array","from","map","c","Number","getComputedStyle","getPropertyValue","replace","min","reduce","acc","val","ceil","sqrt","abs","onResize","totalMin","minToMeasure","window","innerWidth","style","flexWrap","resizeableChildren","child","idx","props","resize","document","getElementById","filter","Boolean","config","attributes","attributeFilter","attributeOldValue","callback","mutationsList","requestAnimationFrame","isArray","mutation","type","target","HTMLElement","newTotalMin","offsetWidth","observer","MutationObserver","forEach","el","observe","disconnect","addEventListener","removeEventListener","ref","id","Child"],"mappings":"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"}