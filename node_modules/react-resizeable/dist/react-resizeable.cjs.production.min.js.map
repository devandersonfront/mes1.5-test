{"version":3,"file":"react-resizeable.cjs.production.min.js","sources":["../src/styles.ts","../src/child.tsx","../src/resizeable.tsx","../src/random-string.ts","../src/median.ts","../src/debounce.ts"],"sourcesContent":["import styled, { css } from 'styled-components';\n\nexport const Parent = styled.div<ReactResizeable.ResizeableProps>`\n  position: relative;\n  display: flex;\n  flex-direction: ${({ flexDirection }) => flexDirection};\n  height: ${({ height }) => height ?? 'auto'};\n  flex-wrap: initial;\n`;\n\nconst baseResizeStyle = (resizeDir: ReactResizeable.ResizeDirection) => css`\n  resize: ${resizeDir};\n  overflow: 'auto';\n`;\n\nconst resizeStyles = ({\n  resizeable,\n  resizeDir,\n}: ReactResizeable.ChildProps['resize']) => {\n  if (!resizeable && !resizeDir) return;\n\n  return resizeDir === 'both' || resizeDir === 'vertical'\n    ? css`\n        ${baseResizeStyle(resizeDir)};\n        height: auto;\n      `\n    : baseResizeStyle(resizeDir!);\n};\n\nexport const StyledChild = styled.div<ReactResizeable.ChildProps['resize']>`\n  min-height: ${({ minHeight }) => minHeight ?? 'auto'};\n  height: ${({ height }) => height ?? '100%'};\n  overflow: scroll;\n  width: ${({ width }) => width};\n  min-width: ${({ minWidth }) => minWidth ?? 'min-content'};\n  flex-grow: 1;\n\n  ${resizeStyles}\n`;\n","import * as React from 'react';\n\nimport { StyledChild } from './styles';\n\nconst Child: React.FC<ReactResizeable.ChildProps> = React.forwardRef(\n  ({ children, resize, ...props }, ref) => (\n    <StyledChild ref={ref} {...resize} {...props}>\n      {children}\n    </StyledChild>\n  )\n);\n\nexport default Child;\n","import * as React from 'react';\n\nimport { Parent } from './styles';\nimport { debounce } from './debounce';\nimport { median } from './median';\nimport { generateRandomString } from './random-string';\n\nconst Resizeable: React.FC<ReactResizeable.ResizeableProps> = ({\n  children,\n  as = 'div',\n  flexDirection = 'row',\n  height = '100%',\n}) => {\n  const [resizeId] = React.useState(generateRandomString());\n  const parent = React.useRef<HTMLElement>(null);\n  const minWidth = React.useRef(0);\n  const medianRootWidth = React.useRef(0);\n  const totalMinWidths = React.useRef(0);\n  const resizeWidthDiff = React.useRef(0);\n\n  React.useEffect(() => {\n    if (!parent.current) return;\n\n    let widths: number[] = [];\n    let totalByResize = { resizeTotalWidths: 0, nonResizeTotalWidths: 0 };\n\n    Array.from(parent.current.children).map(c => {\n      const width = Number(\n        getComputedStyle(c)\n          .getPropertyValue('min-width')\n          .replace('px', '')\n      );\n      widths = [...widths, width];\n\n      if (getComputedStyle(c).getPropertyValue('resize') === 'none') {\n        totalByResize = {\n          ...totalByResize,\n          nonResizeTotalWidths: totalByResize.nonResizeTotalWidths + width,\n        };\n      } else {\n        totalByResize = {\n          ...totalByResize,\n          resizeTotalWidths: totalByResize.resizeTotalWidths + width,\n        };\n      }\n    });\n\n    minWidth.current = Math.min(...widths);\n\n    totalMinWidths.current = widths.reduce((acc, val) => val + acc, 0);\n\n    medianRootWidth.current = Math.ceil(Math.sqrt(median(widths)));\n\n    resizeWidthDiff.current = Math.abs(\n      totalByResize.resizeTotalWidths - totalByResize.nonResizeTotalWidths\n    );\n  }, [parent]);\n\n  const onResize = React.useCallback(\n    ({ totalMin }: { totalMin?: number } = {}) => {\n      if (!parent.current) return;\n\n      const minToMeasure = totalMin ?? totalMinWidths.current;\n\n      if (minToMeasure >= window.innerWidth) {\n        parent.current.style.flexWrap = 'wrap';\n        parent.current.style.height = 'auto';\n      } else {\n        parent.current.style.flexWrap = '';\n        parent.current.style.height = height;\n      }\n    },\n    [parent, totalMinWidths.current]\n  );\n\n  React.useEffect(() => {\n    // setup MutationObserver\n    const resizeableChildren:\n      | HTMLElement[]\n      | undefined\n      | {}[] = React.Children.map(children, (child, idx) => {\n      if (!React.isValidElement(child)) return child;\n\n      return child.props?.resize?.resizeable\n        ? document.getElementById(`resizeable-${resizeId}-${idx}`)\n        : null;\n    })?.filter(child => Boolean(child));\n\n    const config = {\n      attributes: true,\n      attributeFilter: ['style'],\n      attributeOldValue: true,\n    };\n\n    const callback: MutationCallback = mutationsList => {\n      window.requestAnimationFrame(() => {\n        if (!Array.isArray(mutationsList) || !mutationsList.length) {\n          return;\n        }\n        // Use traditional 'for loops' for IE 11\n        for (let mutation of mutationsList) {\n          if (mutation.type !== 'attributes') return;\n\n          if (mutation.target instanceof HTMLElement) {\n            const newTotalMin =\n              totalMinWidths.current -\n              minWidth.current +\n              mutation.target.offsetWidth +\n              medianRootWidth.current +\n              resizeWidthDiff.current;\n\n            if (newTotalMin >= window.innerWidth) {\n              onResize({\n                totalMin: newTotalMin,\n              });\n            }\n          }\n        }\n      });\n    };\n\n    const observer = new MutationObserver(callback);\n\n    resizeableChildren?.forEach(el => {\n      if (el instanceof HTMLElement) {\n        observer.observe(el, config);\n      }\n    });\n    return () => {\n      observer.disconnect();\n    };\n  }, []);\n\n  React.useEffect(() => {\n    // on initial mount ensure proper flex layout\n    onResize();\n  }, [onResize]);\n\n  React.useEffect(() => {\n    // @ts-ignore it complains we're not typing the event but we don't care about it\n    window.addEventListener('resize', debounce(onResize, 200));\n\n    return () => {\n      // @ts-ignore it complains we're not typing the event but we don't care about it\n      window.removeEventListener('resize', onResize);\n    };\n  }, [onResize]);\n\n  return (\n    <Parent as={as} ref={parent} flexDirection={flexDirection} height={height}>\n      {React.Children.map(children, (child, idx) => {\n        if (!React.isValidElement(child)) return child;\n\n        return React.cloneElement(child, {\n          ...child.props,\n          id: `resizeable-${resizeId}-${idx}`,\n        });\n      })}\n    </Parent>\n  );\n};\n\nexport default Resizeable;\n","export const generateRandomString = () =>\n  Math.random()\n    .toString(20)\n    .substr(2, 20);\n","export const median = (arr: number[]) => {\n  const mid = Math.floor(arr.length / 2);\n  const sorted = [...arr].sort((a, b) => a - b);\n\n  return arr.length % 2 !== 0\n    ? sorted[mid]\n    : (sorted[mid - 1] + sorted[mid]) / 2;\n};\n","type Procedure = (...args: any[]) => void;\n\nexport const debounce = <F extends Procedure>(func: F, waitFor: number) => {\n  let timeout: ReturnType<typeof setTimeout> | null = null;\n\n  const debounced = (...args: Parameters<F>) => {\n    if (timeout !== null) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n    timeout = setTimeout(() => func(...args), waitFor);\n  };\n\n  return debounced as (...args: Parameters<F>) => ReturnType<F>;\n};\n"],"names":["Parent","styled","div","flexDirection","height","baseResizeStyle","resizeDir","css","resizeStyles","resizeable","StyledChild","minHeight","width","minWidth","React","ref","children","resize","props","as","resizeId","Math","random","toString","substr","parent","medianRootWidth","totalMinWidths","resizeWidthDiff","current","arr","mid","sorted","widths","totalByResize","resizeTotalWidths","nonResizeTotalWidths","Array","from","map","c","Number","getComputedStyle","getPropertyValue","replace","min","reduce","acc","val","ceil","sqrt","floor","length","sort","a","b","abs","onResize","totalMin","window","innerWidth","style","flexWrap","resizeableChildren","child","idx","document","getElementById","_React$Children$map","filter","Boolean","config","attributes","attributeFilter","attributeOldValue","observer","MutationObserver","mutationsList","requestAnimationFrame","isArray","mutation","type","target","HTMLElement","newTotalMin","offsetWidth","forEach","el","observe","disconnect","func","timeout","addEventListener","args","clearTimeout","setTimeout","removeEventListener","id"],"mappings":"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"}